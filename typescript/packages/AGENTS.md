# Agent Guidelines: x402 SDK Packages

## Package Identity
- **Scope**: Core logic, Chain mechanisms, HTTP adapters.
- **Tech**: TypeScript, `tsup` (Build), `vitest` (Test).
- **Context**: Used by `packages/core`, `packages/mechanisms/*`, `packages/http/*`.

## Setup & Run
- **Build**: `pnpm build` (Uses `tsup`)
- **Test**: `pnpm test` (Uses `vitest`)
- **Test Watch**: `pnpm test:watch`
- **Integration**: `pnpm test:integration` (May require network)

## Patterns & Conventions
### File Structure
- **Source**: `src/`
- **Entry**: `src/index.ts`
- **Dist**: `dist/` (Generated by tsup)
- **Exports**: Named exports preferred.
    - ✅ DO: `export class MyClass { ... }`
    - ❌ DON'T: `export default class ...`

### Coding Standards
- **Strict TS**: No `any`. Use generics/interfaces.
- **Zod**: Use `zod` for runtime validation (especially in `http` packages).
- **Interfaces**: Defined in `@x402/core` are implemented by mechanisms.

### Adding New Packages
- Follow existing structure (e.g., copy `packages/http/express` for new adapters).
- Must have `tsup.config.ts` and `vitest.config.ts`.
- Add to `pnpm-workspace.yaml` (automatic via globs usually).

## Touch Points
- **Core Interfaces**: `packages/core/src/types/`
- **Chain Client**: `packages/core/src/client/`
- **Mechanism Example**: `packages/mechanisms/evm/src/`

## JIT Index Hints
- **Find Interface**: `rg "interface .* {" packages/core`
- **Find Test**: `find . -name "*.test.ts"`
- **Check Exports**: `cat package.json | grep exports`

## Pre-PR Checks
- Run from package root: `pnpm build && pnpm test && pnpm lint`
